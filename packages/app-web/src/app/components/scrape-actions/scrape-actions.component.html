<form>
  <ion-row
    *ngFor="let actionFg of actionsFg.controls.actions.controls"
    [formGroup]="actionFg"
  >
    <ion-col size="2">
      <app-select [options]="scrapeActionOptions"
                  [required]="true"
                  [labelFn]="'label'"
                  (valueChanged)="actionFg.controls.type.setValue($event.key)"></app-select>
    </ion-col>
    <ion-col size="10" class="flex">
      <!-- click -->
      <div
        class="flex"
        [formGroup]="actionFg.controls.oneOf.controls.click"
        *ngIf="actionFg.controls.type.value === 'click'"
      >
        <app-select placeholder="Choose Action"
                    [labelFn]="'label'"
                    [required]="true"
                    (valueChanged)="actionFg.controls.oneOf.controls.click.controls.type.setValue($event.key)"
                    [options]="clickTypes">
        </app-select>

        <ng-container
          *ngIf="
            actionFg.controls.oneOf.controls.click.controls.type.value ===
            'element'
          "
        >
          <input type="text"
                 [formControl]="actionFg.controls.oneOf.controls.click.controls.oneOf.controls.selector"
                 placeholder="Button name (or XPath)"
                 pInputText />
          <ion-button
            [color]="
              getColorForControl(
                actionFg.controls.oneOf.controls.click.controls.oneOf.controls
                  .selector
              )
            "
            size="small"
            (click)="
              triggerPickElement(
                actionFg.controls.oneOf.controls.click.controls.oneOf.controls
                  .selector
              )
            "
          >
            <ion-icon name="color-wand-outline"></ion-icon>
          </ion-button>
        </ng-container>

        <ng-container
          *ngIf="
            actionFg.controls.oneOf.controls.click.controls.type.value ===
            'position'
          "
        >
          <input type="text"
                 [value]="
              formatPosition(
                actionFg.controls.oneOf.controls.click.controls.oneOf.controls
                  .position
              )
            "
                 placeholder="X/Y coordinates"
                 [readOnly]="true"
                 pInputText />

          <ion-button
            size="small"
            [color]="
              getColorForControl(
                actionFg.controls.oneOf.controls.click.controls.oneOf.controls
                  .position
              )
            "
            (click)="
              triggerPickPosition(
                actionFg.controls.oneOf.controls.click.controls.oneOf.controls
                  .position
              )
            "
          >
            <ion-icon name="add-outline"></ion-icon>
          </ion-button>
        </ng-container>
      </div>

      <!-- cookie -->
      <div
        class="flex"
        [formGroup]="actionFg.controls.oneOf.controls.cookie"
        *ngIf="actionFg.controls.type.value === 'cookie'"
      >
        <input type="text"
               [formControl]="actionFg.controls.oneOf.controls.cookie.controls.text"
               placeholder="Set raw cookie string"
               pInputText />
      </div>

      <!-- wait -->
      <div
        class="flex"
        [formGroup]="actionFg.controls.oneOf.controls.wait"
        *ngIf="actionFg.controls.type.value === 'wait'"
      >
        <input type="text"
               [formControl]="actionFg.controls.oneOf.controls.wait.controls.selector"
               placeholder="XPath"
               pInputText />
        <ion-button
          color="light"
          size="small"
          (click)="
            triggerPickElement(
              actionFg.controls.oneOf.controls.wait.controls.selector
            )
          "
        >
          <ion-icon name="color-wand-outline"></ion-icon>
        </ion-button>
      </div>

      <!-- type -->
      <ng-container
        [formGroup]="actionFg.controls.oneOf.controls.cookie"
        *ngIf="actionFg.controls.type.value === 'type'"
      >
        <div class="flex">
          <input type="text"
                 [formControl]="actionFg.controls.oneOf.controls.type.controls.selector"
                 placeholder="XPath"
                 pInputText />

          <ion-button
            color="light"
            size="small"
            (click)="
              triggerPickElement(
                actionFg.controls.oneOf.controls.type.controls.selector
              )
            "
          >
            <ion-icon name="color-wand-outline"></ion-icon>
          </ion-button>
        </div>
        <div class="flex">
          <input type="text"
                 [formControl]="actionFg.controls.oneOf.controls.type.controls.text"
                 placeholder="Type here"
                 pInputText />
        </div>
      </ng-container>

      <!-- select -->
      <ng-container
        [formGroup]="actionFg.controls.oneOf.controls.select"
        *ngIf="actionFg.controls.type.value === 'select'"
      >
        <div class="flex">
          <input type="text"
                 [formControl]="actionFg.controls.oneOf.controls.select.controls.selector"
                 placeholder="XPath"
                 pInputText />
          <ion-button
            color="light"
            size="small"
            (click)="
              triggerPickElement(
                actionFg.controls.oneOf.controls.select.controls.selector
              )
            "
          >
            <ion-icon name="color-wand-outline"></ion-icon>
          </ion-button>
        </div>
        <div class="flex">
          <input type="text"
                 [formControl]="actionFg.controls.oneOf.controls.select.controls.text"
                 placeholder="Value of Select"
                 pInputText />
        </div>
      </ng-container>

      <!-- header -->
      <ng-container
        [formGroup]="actionFg.controls.oneOf.controls.header"
        *ngIf="actionFg.controls.type.value === 'header'"
      >
        <div class="flex">
          <input type="text"
                 [formControl]="actionFg.controls.oneOf.controls.header.controls.name"
                 placeholder="Set Header name"
                 pInputText />
        </div>
        <div class="flex">
          <input type="text"
                 [formControl]="actionFg.controls.oneOf.controls.header.controls.text"
                 placeholder="Set Header value"
                 pInputText />
        </div>
      </ng-container>

      <ion-button
        aria-label="Remove"
        color="light"
        size="small"
        (click)="deleteAction(actionFg)"
      >
        <ion-icon name="trash-outline"></ion-icon>
      </ion-button>
    </ion-col>
  </ion-row>
  <ion-row>
    <ion-col size="10">
      <ion-button
        size="small"
        color="light"
        (click)="addAction()"
      >
        <ion-icon name="add-outline"></ion-icon>
      </ion-button>
    </ion-col>
  </ion-row>


  <ion-row *ngIf="pickFragment">
    <ion-col size="12" class="flex">
      <ion-button color="light">Fragment</ion-button>
      <!-- click -->
      <div class="flex">
        <app-select [formControl]="fragmentFg.controls.fragmentType"
                    [labelFn]="'label'"
                    [options]="fragmentTypes">
        </app-select>

        <ng-container
          *ngIf="fragmentFg.controls.fragmentType.value === 'element'"
        >
          <input type="text"
                 [formControl]="fragmentFg.controls.xpath"
                 placeholder="XPath"
                 pInputText />
          <ion-button
            [color]="
            getColorForControl(fragmentFg.controls.xpath)
          "
            size="small"
            (click)="
            triggerPickElement(fragmentFg.controls.xpath)
          "
          >
            <ion-icon name="color-wand-outline"></ion-icon>
          </ion-button>
        </ng-container>

        <ng-container
          *ngIf="fragmentFg.controls.fragmentType.value === 'boundingBox'">

          <input type="text"
                 [value]="formatBoundingBox(fragmentFg.controls.boundingBox.value)"
                 placeholder="Bounding Box"
                 pInputText />
          <ion-button
            size="small"
            [color]="
            getColorForControl(fragmentFg.controls.boundingBox)
          "
            (click)="
            triggerPickBoundingBox(fragmentFg.controls.boundingBox)
          "
          >
            <ion-icon name="add-outline"></ion-icon>
          </ion-button>
        </ng-container>
      </div>
    </ion-col>
  </ion-row>
</form>
