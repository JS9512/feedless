<app-responsive-columns class="flex">
  <div class="flex flex__column" left>
    <div style="flex: 1; position: relative; overflow-y: auto">
      <ng-content select="[topSlot]"></ng-content>
      <ion-list style="position: absolute; width: 100%">
        <ion-list-header>
          <ion-label>
            <strong>{{ nativeFeeds.length }}</strong>
            Native Feeds
          </ion-label>
        </ion-list-header>
        <ion-item
          (click)="pickNativeFeed(nativeFeed)"
          *ngFor="let nativeFeed of nativeFeeds"
          [button]="true"
          [color]="currentNativeFeed === nativeFeed ? 'dark' : undefined"
          class="feed cy-feed-native"
        >
          <ion-label class="ion-margin-start">
            {{ nativeFeed?.title }}
          </ion-label>
          <ion-icon
            [color]="isNonSelected ? 'primary' : undefined"
            name="chevron-forward"
          ></ion-icon>
        </ion-item>

        <ion-list-header>
          <ion-label>
            <strong>{{ genericFeeds.length }}</strong>
            Generic Feeds
          </ion-label>
        </ion-list-header>
        <ng-container *ngFor="let genericFeed of genericFeeds">
          <ion-item
            (click)="pickGenericFeed(genericFeed)"
            [button]="true"
            [color]="
              currentGenericFeed?.hash === genericFeed.hash ? 'dark' : undefined
            "
            class="feed cy-feed-generic"
          >
            <ion-label class="ion-margin-start"
            >{{ genericFeed.count }} articles
              <span *ngIf="genericFeed.selectors.dateXPath">+date</span>
            </ion-label>
            <ion-icon
              [color]="isNonSelected ? 'primary' : undefined"
              name="chevron-forward"
            ></ion-icon>
            <div
              [ngStyle]="{ width: getRelativeScore(genericFeed) + '%' }"
              class="generic-feed-score"
            ></div>
          </ion-item>
        </ng-container>
      </ion-list>
    </div>

    <ion-list class="popup-floater">
      <ion-list-header (click)="showSelectors = !showSelectors">
        <ion-label>Generic Feed Selectors</ion-label>
      </ion-list-header>
      <ng-container *ngIf="showSelectors">
        <ion-item>
          <ion-input
            [formControl]="formGroup.controls.contextXPath"
            color="primary"
            label="Context"
            labelPlacement="stacked"
            name="contextXPath"
            placeholder="xpath from root"
          ></ion-input>
        </ion-item>
        <ion-item>
          <ion-input
            [formControl]="formGroup.controls.linkXPath"
            color="primary"
            label="Link"
            labelPlacement="stacked"
            name="linkXPath"
            placeholder="relative xpath from context"
          ></ion-input>
        </ion-item>
        <ion-item>
          <ion-select
            [formControl]="formGroup.controls.extendContext"
            [required]="true"
            label="Extend Context"
            labelPlacement="stacked"
            name="extendContext"
          >
            <ion-select-option
              *ngFor="let extendContextOption of getExtendContextOptions()"
              [value]="extendContextOption.value"
            >
              + {{ extendContextOption.label }}
            </ion-select-option>
          </ion-select>
        </ion-item>
        <ion-item>
          <ion-input
            [formControl]="formGroup.controls.dateXPath"
            color="primary"
            label="Date"
            labelPlacement="stacked"
            name="dateXPath"
            placeholder="relative xpath from context"
          ></ion-input>
        </ion-item>
        <ion-item *ngIf="formGroup.value.dateXPath">
          <ion-checkbox
            [formControl]="formGroup.controls.dateIsStartOfEvent"
            labelPlacement="end"
            name="dateIsStartOfEvent"
            slot="start"
          >Date is Beginning of Event
          </ion-checkbox
          >
        </ion-item>
      </ng-container>
    </ion-list>

    <ng-content select="[bottomSlot]"></ng-content>
  </div>

  <div class="flex__column" right style="flex: 2; position: relative">
    <app-embedded-website
      [embed]="embedWebsiteData"
      [highlightXpath]="currentGenericFeed?.selectors?.contextXPath"
      [ngClass]="{ hidden: !!currentNativeFeed }"
      class="flex"
    ></app-embedded-website>

    <app-remote-feed
      *ngIf="currentNativeFeed"
      [feedUrl]="currentNativeFeed.feedUrl"
      [title]="currentNativeFeed.title"
      class="flex"
    ></app-remote-feed>
    <div *ngIf="busy" class="overlay">
      <div class="overlay__background"></div>
      <ion-spinner name="dots"></ion-spinner>
    </div>
  </div>
</app-responsive-columns>
