<ion-header style="box-shadow: none">
  <ion-toolbar style="--background: transparent">
    <ion-title slot="start">
      <span [innerHtml]="productConfig?.titleHtml"></span>
    </ion-title>

    <ion-buttons slot="end">
      <app-dark-mode-button></app-dark-mode-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content>
  <div style="width: 700px; margin-left: auto; margin-right: auto; display: flex; flex-direction: column">
    <div style="display: flex">
      <h3 class="ion-margin-end">
        <ion-text color="danger">Ort</ion-text>
      </h3>
      <ion-input color="danger" fill="outline" [formControl]="locationFc"></ion-input>
    </div>
    <ion-list *ngIf="locationSuggestions?.length > 0">
      <ion-item *ngFor="let location of locationSuggestions"
                (click)="setLocation(location)"
                [button]="true">
        {{location.display_name}}
      </ion-item>
    </ion-list>
<!--    <div style="display: flex">-->
<!--      <h3 class="ion-margin-end">-->
<!--        <ion-text color="danger">Distanz</ion-text>-->
<!--      </h3>-->
<!--      <ion-select>-->
<!--        <ion-select-option>10 Km</ion-select-option>-->
<!--        <ion-select-option>20 Km</ion-select-option>-->
<!--      </ion-select>-->
<!--    </div>-->

    <div class="calendar ion-margin-top">
      <ion-toolbar style="--background: transparent">
        <ion-buttons slot="start">
          <ion-button (click)="goToDateRelative(-1, 'month')">
            <ion-icon name="chevron-back-outline"></ion-icon>
          </ion-button>
        </ion-buttons>

        <ion-title class="ion-text-center">
          {{ currentDateRef.format('MMMM') }} {{ currentDateRef.format('YYYY') }}
        </ion-title>

        <ion-buttons slot="end">
          <ion-button (click)="goToDateRelative(1, 'month')">
            <ion-icon name="chevron-forward-outline"></ion-icon>
          </ion-button>
        </ion-buttons>
      </ion-toolbar>

      <div class="calendar__body" *ngFor="let year of years | keyvalue">
        <ng-container *ngFor="let month of year.value | keyvalue">
          <div
            class="day no-background ion-text-center ion-text-uppercase"
            *ngFor="let day of filterFirstWeek(month.value)"
          >
            {{ day.day.format("ddd") }}
          </div>
          <div
            *ngFor="let day of month.value"
            class="day"
            [ngClass]="{
            'day--today': day.today,
            'day--other': day.otherMonth,
            'no-background': day.otherMonth,
            'day--active': day === currentDay,
            'day--past': day.past
          }"
          >
            <a href="javascript:void(0)" (click)="currentDay = day">
              <div>
                <h4 class="ion-text-center">
                <span *ngIf="day.printMonth">
                  {{ day.day.format("MMM") }}
                </span>
                  <span class="date">
                  {{ day.day.format("D") }}
                </span>
                </h4>
                <div class="ion-text-center" style="color: var(--ion-color-danger)">
                  <span></span>
                  <span *ngFor="let dot of getDots(day.day)">
                    &#9679;
                  </span>
                </div>
              </div>
            </a>
          </div>
        </ng-container>
      </div>
    </div>
    <div class="ion-margin-top">
      <ng-container *ngIf="currentDay">
        <ion-toolbar style="--background: transparent">
          <ion-title>
            Veranstaltungen am
            {{ currentDay.day.format("D") }}.
            {{ currentDay.day.format("MMMM") }}
            {{ currentDay.day.format("YY") }}
            nahe {{ locationFc.value }}
          </ion-title>
        </ion-toolbar>
        <div class="ion-padding-horizontal">
          <p *ngIf="getEvents(currentDay.day).length === 0">
            Keine Eintr√§ge gefunden
          </p>
          <ul *ngFor="let group of getEventGroups(currentDay.day)">
            <h3 class="ion-padding-top">{{group.distance}} Km</h3>
            <li *ngFor="let event of group.events">
              <h4>
                <a [href]="event.url">{{ event.contentTitle }}</a></h4>
              <p>
                {{ event.contentText }}
              </p>
            </li>
          </ul>
        </div>
      </ng-container>
    </div>
  </div>
</ion-content>

<ion-footer class="ion-text-center">
  <div>made in Aargau by Markus Ruepp</div>
</ion-footer>
