<!DOCTYPE html>
<!-- saved from url=(0075)https://felx.me/2021/08/29/improving-the-hacker-news-ranking-algorithm.html -->
<html lang="en" class="fontawesome-i2svg-active fontawesome-i2svg-complete"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style type="text/css">svg:not(:root).svg-inline--fa{overflow:visible}.svg-inline--fa{display:inline-block;font-size:inherit;height:1em;overflow:visible;vertical-align:-.125em}.svg-inline--fa.fa-lg{vertical-align:-.225em}.svg-inline--fa.fa-w-1{width:.0625em}.svg-inline--fa.fa-w-2{width:.125em}.svg-inline--fa.fa-w-3{width:.1875em}.svg-inline--fa.fa-w-4{width:.25em}.svg-inline--fa.fa-w-5{width:.3125em}.svg-inline--fa.fa-w-6{width:.375em}.svg-inline--fa.fa-w-7{width:.4375em}.svg-inline--fa.fa-w-8{width:.5em}.svg-inline--fa.fa-w-9{width:.5625em}.svg-inline--fa.fa-w-10{width:.625em}.svg-inline--fa.fa-w-11{width:.6875em}.svg-inline--fa.fa-w-12{width:.75em}.svg-inline--fa.fa-w-13{width:.8125em}.svg-inline--fa.fa-w-14{width:.875em}.svg-inline--fa.fa-w-15{width:.9375em}.svg-inline--fa.fa-w-16{width:1em}.svg-inline--fa.fa-w-17{width:1.0625em}.svg-inline--fa.fa-w-18{width:1.125em}.svg-inline--fa.fa-w-19{width:1.1875em}.svg-inline--fa.fa-w-20{width:1.25em}.svg-inline--fa.fa-pull-left{margin-right:.3em;width:auto}.svg-inline--fa.fa-pull-right{margin-left:.3em;width:auto}.svg-inline--fa.fa-border{height:1.5em}.svg-inline--fa.fa-li{width:2em}.svg-inline--fa.fa-fw{width:1.25em}.fa-layers svg.svg-inline--fa{bottom:0;left:0;margin:auto;position:absolute;right:0;top:0}.fa-layers{display:inline-block;height:1em;position:relative;text-align:center;vertical-align:-.125em;width:1em}.fa-layers svg.svg-inline--fa{-webkit-transform-origin:center center;transform-origin:center center}.fa-layers-counter,.fa-layers-text{display:inline-block;position:absolute;text-align:center}.fa-layers-text{left:50%;top:50%;-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%);-webkit-transform-origin:center center;transform-origin:center center}.fa-layers-counter{background-color:#ff253a;border-radius:1em;-webkit-box-sizing:border-box;box-sizing:border-box;color:#fff;height:1.5em;line-height:1;max-width:5em;min-width:1.5em;overflow:hidden;padding:.25em;right:0;text-overflow:ellipsis;top:0;-webkit-transform:scale(.25);transform:scale(.25);-webkit-transform-origin:top right;transform-origin:top right}.fa-layers-bottom-right{bottom:0;right:0;top:auto;-webkit-transform:scale(.25);transform:scale(.25);-webkit-transform-origin:bottom right;transform-origin:bottom right}.fa-layers-bottom-left{bottom:0;left:0;right:auto;top:auto;-webkit-transform:scale(.25);transform:scale(.25);-webkit-transform-origin:bottom left;transform-origin:bottom left}.fa-layers-top-right{right:0;top:0;-webkit-transform:scale(.25);transform:scale(.25);-webkit-transform-origin:top right;transform-origin:top right}.fa-layers-top-left{left:0;right:auto;top:0;-webkit-transform:scale(.25);transform:scale(.25);-webkit-transform-origin:top left;transform-origin:top left}.fa-lg{font-size:1.33333em;line-height:.75em;vertical-align:-.0667em}.fa-xs{font-size:.75em}.fa-sm{font-size:.875em}.fa-1x{font-size:1em}.fa-2x{font-size:2em}.fa-3x{font-size:3em}.fa-4x{font-size:4em}.fa-5x{font-size:5em}.fa-6x{font-size:6em}.fa-7x{font-size:7em}.fa-8x{font-size:8em}.fa-9x{font-size:9em}.fa-10x{font-size:10em}.fa-fw{text-align:center;width:1.25em}.fa-ul{list-style-type:none;margin-left:2.5em;padding-left:0}.fa-ul>li{position:relative}.fa-li{left:-2em;position:absolute;text-align:center;width:2em;line-height:inherit}.fa-border{border:solid .08em #eee;border-radius:.1em;padding:.2em .25em .15em}.fa-pull-left{float:left}.fa-pull-right{float:right}.fa.fa-pull-left,.fab.fa-pull-left,.fal.fa-pull-left,.far.fa-pull-left,.fas.fa-pull-left{margin-right:.3em}.fa.fa-pull-right,.fab.fa-pull-right,.fal.fa-pull-right,.far.fa-pull-right,.fas.fa-pull-right{margin-left:.3em}.fa-spin{-webkit-animation:fa-spin 2s infinite linear;animation:fa-spin 2s infinite linear}.fa-pulse{-webkit-animation:fa-spin 1s infinite steps(8);animation:fa-spin 1s infinite steps(8)}@-webkit-keyframes fa-spin{0%{-webkit-transform:rotate(0);transform:rotate(0)}100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes fa-spin{0%{-webkit-transform:rotate(0);transform:rotate(0)}100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}.fa-rotate-90{-webkit-transform:rotate(90deg);transform:rotate(90deg)}.fa-rotate-180{-webkit-transform:rotate(180deg);transform:rotate(180deg)}.fa-rotate-270{-webkit-transform:rotate(270deg);transform:rotate(270deg)}.fa-flip-horizontal{-webkit-transform:scale(-1,1);transform:scale(-1,1)}.fa-flip-vertical{-webkit-transform:scale(1,-1);transform:scale(1,-1)}.fa-flip-horizontal.fa-flip-vertical{-webkit-transform:scale(-1,-1);transform:scale(-1,-1)}:root .fa-flip-horizontal,:root .fa-flip-vertical,:root .fa-rotate-180,:root .fa-rotate-270,:root .fa-rotate-90{-webkit-filter:none;filter:none}.fa-stack{display:inline-block;height:2em;position:relative;width:2em}.fa-stack-1x,.fa-stack-2x{bottom:0;left:0;margin:auto;position:absolute;right:0;top:0}.svg-inline--fa.fa-stack-1x{height:1em;width:1em}.svg-inline--fa.fa-stack-2x{height:2em;width:2em}.fa-inverse{color:#fff}.sr-only{border:0;clip:rect(0,0,0,0);height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;width:1px}.sr-only-focusable:active,.sr-only-focusable:focus{clip:auto;height:auto;margin:0;overflow:visible;position:static;width:auto}</style><link rel="stylesheet" href="./Improving the Hacker News Ranking Algorithm _ Felix Dietze’s blog_files/normalize.css">
<link rel="stylesheet" href="./Improving the Hacker News Ranking Algorithm _ Felix Dietze’s blog_files/open-color.css">
<link rel="stylesheet" href="./Improving the Hacker News Ranking Algorithm _ Felix Dietze’s blog_files/styles.css">
<link type="application/atom+xml" rel="alternate" href="https://felx.me/feed.xml" title="Felix Dietze&#39;s blog">

<title>Improving the Hacker News Ranking Algorithm | Felix Dietze’s blog</title>
<meta name="generator" content="Jekyll v3.9.3">
<meta property="og:title" content="Improving the Hacker News Ranking Algorithm">
<meta property="og:locale" content="en_US">
<meta name="description" content="In our opinion, the goal of Hacker News (HN) is to find the highest quality submissions (according to its community) and show them on the front-page. While the current ranking algorithm seems to meet this requirement at first glance, we identified two inherent flaws.">
<meta property="og:description" content="In our opinion, the goal of Hacker News (HN) is to find the highest quality submissions (according to its community) and show them on the front-page. While the current ranking algorithm seems to meet this requirement at first glance, we identified two inherent flaws.">
<link rel="canonical" href="https://felx.me/2021/08/29/improving-the-hacker-news-ranking-algorithm.html">
<meta property="og:url" content="https://felx.me/2021/08/29/improving-the-hacker-news-ranking-algorithm.html">
<meta property="og:site_name" content="Felix Dietze’s blog">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2021-08-29T00:00:00+00:00">
<meta name="twitter:card" content="summary">
<meta property="twitter:title" content="Improving the Hacker News Ranking Algorithm">
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2021-08-29T00:00:00+00:00","datePublished":"2021-08-29T00:00:00+00:00","description":"In our opinion, the goal of Hacker News (HN) is to find the highest quality submissions (according to its community) and show them on the front-page. While the current ranking algorithm seems to meet this requirement at first glance, we identified two inherent flaws.","headline":"Improving the Hacker News Ranking Algorithm","mainEntityOfPage":{"@type":"WebPage","@id":"https://felx.me/2021/08/29/improving-the-hacker-news-ranking-algorithm.html"},"url":"https://felx.me/2021/08/29/improving-the-hacker-news-ranking-algorithm.html"}</script>

<script async="" src="./Improving the Hacker News Ranking Algorithm _ Felix Dietze’s blog_files/all.js"></script>
<script data-goatcounter="https://felx.goatcounter.com/count" async="" src="./Improving the Hacker News Ranking Algorithm _ Felix Dietze’s blog_files/count.js"></script>
</head>
<body>
<div class="container">
<header class="masthead">
<div class="masthead-title">
<a href="https://felx.me/" title="Home">Felix Dietze's blog</a>
<small class="tagline"></small>
</div>
</header>
<main>
<article class="post">
<h1 class="post-title">Improving the Hacker News Ranking Algorithm</h1>
<div class="post-meta">
<time datetime="2021-08-29T00:00:00+00:00" itemprop="datePublished">
29 Aug 2021
</time><span> • </span>
<span itemprop="author" itemscope="" itemtype="http://schema.org/Person"><a href="mailto:felix.dietze@rwth-aachen.de"><span itemprop="name">Felix Dietze</span></a>
</span>,
<span itemprop="author" itemscope="" itemtype="http://schema.org/Person"><a href="mailto:nakayama@comm.rwth-aachen.de"><span itemprop="name">Johannes Nakayama</span></a>
</span>
</div>
<p><em>Update: <a href="https://news.ycombinator.com/item?id=28391659">Comments on Hacker News</a></em></p>
<p><em>Update 2: With all the learnings after writing this post, we built <a href="https://news.social-protocols.org/">Quality News</a>, <a href="https://github.com/social-protocols/news">read about it here.</a></em></p>
<p>In our opinion, the goal of Hacker News (HN) is to find the highest quality submissions (according to its community) and show them on the front-page. While the current ranking algorithm seems to meet this requirement at first glance, we identified two inherent flaws.</p>
<ol>
<li>If a submission lands on the front-page, the number of upvotes it receives does not correlate with its quality. Independent of submission time, weekday, or clickbait titles.</li>
<li>There are false negatives. Some high quality submissions do not receive any upvotes because they are overlooked on the fast-moving new-page.</li>
</ol>
<p>Let’s look at these two issues in detail and try to confirm them with data and some systems thinking tools. <a href="https://console.cloud.google.com/marketplace/product/y-combinator/hacker-news">All HN submissions are available on BigQuery</a>, which we access via this <a href="https://www.kaggle.com/felixdietze/hacker-news-score-analysis">Kaggle notebook</a>. You can find the SQL queries for reproduction and further exploration in the Appendix.</p>
<h2 id="number-of-upvotes-does-not-correlate-with-quality">Number of Upvotes does not Correlate with Quality</h2>
<p>We don’t have a good definition for quality, except that users upvote submissions which they think are of high quality. But even high quality submissions get an inconsistent amount of upvotes. We have some data to back up this claim. Since HN allows URLs to be submitted multiple times, we can look at how many upvotes every submission of the same URL received. Note that submissions need at least two upvotes on the new-page to appear on the front-page and every submission starts with 1 upvote (submitters upvote). The number of upvotes is called <code class="language-plaintext highlighter-rouge">score</code> in the dataset. Let’s look at URLs which have been submitted at least four times with the same title during 30 days where every submission got enough votes to show up on the front-page:</p>
<table>
<thead>
<tr>
<th style="text-align: left">title</th>
<th style="text-align: left">scores_by_time</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left">Cameras and Lenses</td>
<td style="text-align: left">[ 14 7 2132 6]</td>
</tr>
<tr>
<td style="text-align: left">The Death of Microservice Madness in 2018</td>
<td style="text-align: left">[ 5 3 5 5 4 993]</td>
</tr>
<tr>
<td style="text-align: left">It’s later than you think</td>
<td style="text-align: left">[ 4 12 4 914]</td>
</tr>
<tr>
<td style="text-align: left">React Native for Android</td>
<td style="text-align: left">[ 5 6 907 6]</td>
</tr>
<tr>
<td style="text-align: left">The Deep Sea</td>
<td style="text-align: left">[ 7 3 4 3 20 3 703]</td>
</tr>
<tr>
<td style="text-align: left">Swift: Google’s Bet on Differentiable Programming</td>
<td style="text-align: left">[ 13 9 3 675]</td>
</tr>
<tr>
<td style="text-align: left">Undercover reporter reveals life in a Polish troll farm</td>
<td style="text-align: left">[ 5 18 7 665]</td>
</tr>
<tr>
<td style="text-align: left">Edge Computing at Chick-fil-A</td>
<td style="text-align: left">[ 5 4 3 570]</td>
</tr>
<tr>
<td style="text-align: left">Why time management is ruining our lives</td>
<td style="text-align: left">[552 6 4 5 8]</td>
</tr>
<tr>
<td style="text-align: left">The Internet of Beefs</td>
<td style="text-align: left">[ 4 3 3 513]</td>
</tr>
<tr>
<td style="text-align: left">The Distribution of Users’ Computer Skills: Worse Than You Think</td>
<td style="text-align: left">[ 3 5 32 512]</td>
</tr>
<tr>
<td style="text-align: left">All C++20 core language features with examples</td>
<td style="text-align: left">[ 8 3 4 483]</td>
</tr>
<tr>
<td style="text-align: left">Giving GPT-3 a Turing Test</td>
<td style="text-align: left">[ 3 3 12 32 453]</td>
</tr>
<tr>
<td style="text-align: left">Static Analysis in GCC 10</td>
<td style="text-align: left">[ 8 18 9 3 394]</td>
</tr>
<tr>
<td style="text-align: left">Remote code execution in Homebrew by compromising the official Cask repository</td>
<td style="text-align: left">[ 4 4 4 387]</td>
</tr>
<tr>
<td style="text-align: left">Flawed Algorithms Are Grading Millions of Students’ Essays</td>
<td style="text-align: left">[ 7 3 6 358]</td>
</tr>
<tr>
<td style="text-align: left">Getting Started with Security Keys</td>
<td style="text-align: left">[ 12 5 8 346]</td>
</tr>
<tr>
<td style="text-align: left">Google Brain Residency</td>
<td style="text-align: left">[337 3 3 7]</td>
</tr>
<tr>
<td style="text-align: left">Why is China smashing its tech industry?</td>
<td style="text-align: left">[ 10 15 7 10 12 6 311]</td>
</tr>
<tr>
<td style="text-align: left">Why NetNewsWire Is Fast</td>
<td style="text-align: left">[ 14 5 4 298]</td>
</tr>
<tr>
<td style="text-align: left">Statistics, we have a problem</td>
<td style="text-align: left">[ 10 6 8 295]</td>
</tr>
<tr>
<td style="text-align: left">From First Principles: Why Scala?</td>
<td style="text-align: left">[ 7 9 7 286]</td>
</tr>
<tr>
<td style="text-align: left">The rise and fall of the PlayStation supercomputers</td>
<td style="text-align: left">[ 4 3 4 283]</td>
</tr>
<tr>
<td style="text-align: left">Breaking homegrown crypto</td>
<td style="text-align: left">[ 16 4 6 4 282]</td>
</tr>
<tr>
<td style="text-align: left">Random Acts of Optimization</td>
<td style="text-align: left">[ 11 3 15 279]</td>
</tr>
<tr>
<td style="text-align: left">Escaping the SPA rabbit hole with modern Rails</td>
<td style="text-align: left">[ 15 5 274 10]</td>
</tr>
<tr>
<td style="text-align: left">My Fanless OpenBSD Desktop</td>
<td style="text-align: left">[ 10 14 6 3 273]</td>
</tr>
<tr>
<td style="text-align: left">Attack Matrix for Kubernetes</td>
<td style="text-align: left">[ 9 7 272 3]</td>
</tr>
<tr>
<td style="text-align: left">Roadmap to becoming a web developer in 2017</td>
<td style="text-align: left">[ 6 6 4 261]</td>
</tr>
<tr>
<td style="text-align: left">YouTube is now building its own video-transcoding chips</td>
<td style="text-align: left">[ 19 8 3 259]</td>
</tr>
</tbody>
</table>
<p>We observe that the scores are inconsistent. Only a few submissions score high. The low scores are a bit surprising because all submissions got enough votes to make it to the front-page. The high scores indicate that the community perceives these submissions as high quality. But these high-quality URLs have been submitted several times and received different, mostly low scores.</p>
<p>Can this observation be explained by different submission times? Let’s look at submissions of the same URL with the lowest standard deviation of submission time-of-day.</p>
<table>
<thead>
<tr>
<th style="text-align: left">scores</th>
<th style="text-align: left">time_of_day</th>
<th style="text-align: right">time_of_day_stddev</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left">[ 5 2 6 907 6]</td>
<td style="text-align: left">[17 17 17 17 17]</td>
<td style="text-align: right">0.0397911</td>
</tr>
<tr>
<td style="text-align: left">[ 7 2 2 5 107]</td>
<td style="text-align: left">[15 14 15 15 17]</td>
<td style="text-align: right">1.00136</td>
</tr>
<tr>
<td style="text-align: left">[ 2 3 2 2 127]</td>
<td style="text-align: left">[14 10 12 11 11]</td>
<td style="text-align: right">1.23584</td>
</tr>
<tr>
<td style="text-align: left">[ 1 2 1 134 1]</td>
<td style="text-align: left">[13 13 13 15 16]</td>
<td style="text-align: right">1.41784</td>
</tr>
<tr>
<td style="text-align: left">[ 2 5 1 4 173]</td>
<td style="text-align: left">[13 13 8 12 12]</td>
<td style="text-align: right">1.93515</td>
</tr>
<tr>
<td style="text-align: left">[98 1 1 8 3]</td>
<td style="text-align: left">[21 21 21 17 18]</td>
<td style="text-align: right">2.07849</td>
</tr>
<tr>
<td style="text-align: left">[ 3 3 1 1 117]</td>
<td style="text-align: left">[17 19 21 17 21]</td>
<td style="text-align: right">2.1156</td>
</tr>
<tr>
<td style="text-align: left">[ 4 4 4 6 73]</td>
<td style="text-align: left">[14 14 18 18 14]</td>
<td style="text-align: right">2.44152</td>
</tr>
<tr>
<td style="text-align: left">[ 5 5 4 182]</td>
<td style="text-align: left">[16 17 16 16]</td>
<td style="text-align: right">0.363465</td>
</tr>
<tr>
<td style="text-align: left">[ 3 3 2 143]</td>
<td style="text-align: left">[13 15 16 14]</td>
<td style="text-align: right">1.08195</td>
</tr>
<tr>
<td style="text-align: left">[ 2 3 3 87]</td>
<td style="text-align: left">[15 16 15 18]</td>
<td style="text-align: right">1.24167</td>
</tr>
<tr>
<td style="text-align: left">[ 2 5 3 350]</td>
<td style="text-align: left">[14 14 17 14]</td>
<td style="text-align: right">1.44038</td>
</tr>
<tr>
<td style="text-align: left">[ 4 1 2 89]</td>
<td style="text-align: left">[20 19 17 19]</td>
<td style="text-align: right">1.44575</td>
</tr>
<tr>
<td style="text-align: left">[ 1 2 2 51]</td>
<td style="text-align: left">[1 1 2 5]</td>
<td style="text-align: right">1.58321</td>
</tr>
<tr>
<td style="text-align: left">[ 1 2 6 138]</td>
<td style="text-align: left">[14 12 15 12]</td>
<td style="text-align: right">1.58531</td>
</tr>
<tr>
<td style="text-align: left">[ 1 1 1 137]</td>
<td style="text-align: left">[20 20 20 16]</td>
<td style="text-align: right">2.06964</td>
</tr>
<tr>
<td style="text-align: left">[ 1 2 1 85]</td>
<td style="text-align: left">[ 8 13 9 11]</td>
<td style="text-align: right">2.18973</td>
</tr>
<tr>
<td style="text-align: left">[ 3 1 2 85]</td>
<td style="text-align: left">[ 9 8 13 12]</td>
<td style="text-align: right">2.40206</td>
</tr>
<tr>
<td style="text-align: left">[ 1 1 4 61]</td>
<td style="text-align: left">[12 15 16 18]</td>
<td style="text-align: right">2.46466</td>
</tr>
<tr>
<td style="text-align: left">[625 4 6]</td>
<td style="text-align: left">[19 19 19]</td>
<td style="text-align: right">0.0288675</td>
</tr>
</tbody>
</table>
<p>We observe that even for submissions submitted at the same time-of-day, the scores are inconsistent. This means that in general, score does not correlate well with quality. And we conclude that a low score of a single submission is not a good indicator for low quality.</p>
<h2 id="high-quality-content-gets-overlooked">High Quality Content gets Overlooked</h2>
<p>For a submission to be shown on the front-page, it needs to receive at least two upvotes (in addition to the submitter’s vote). But most submissions don’t get any upvotes at all. Here is a distribution of upvote counts for all submissions on Hacker News. Take minute to understand how to read the first two columns of this table. They answer questions like: How many submissions received between 3 and 4 upvotes?</p>
<table>
<thead>
<tr>
<th style="text-align: left">score_interval</th>
<th style="text-align: right">submissions</th>
<th style="text-align: right">subm_fraction</th>
<th style="text-align: right">cumulative_subm_fraction</th>
<th style="text-align: right">total_votes</th>
<th style="text-align: right">votes_fraction</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left">[1 1]</td>
<td style="text-align: right">1790499</td>
<td style="text-align: right">0.474718</td>
<td style="text-align: right">0.474718</td>
<td style="text-align: right">1790499</td>
<td style="text-align: right">0.037396</td>
</tr>
<tr>
<td style="text-align: left">[2 2]</td>
<td style="text-align: right">771249</td>
<td style="text-align: right">0.204483</td>
<td style="text-align: right">0.679201</td>
<td style="text-align: right">1542498</td>
<td style="text-align: right">0.032217</td>
</tr>
<tr>
<td style="text-align: left">[3 4]</td>
<td style="text-align: right">502989</td>
<td style="text-align: right">0.133358</td>
<td style="text-align: right">0.812559</td>
<td style="text-align: right">1667519</td>
<td style="text-align: right">0.034828</td>
</tr>
<tr>
<td style="text-align: left">[5 8]</td>
<td style="text-align: right">215204</td>
<td style="text-align: right">0.057057</td>
<td style="text-align: right">0.869617</td>
<td style="text-align: right">1306686</td>
<td style="text-align: right">0.027291</td>
</tr>
<tr>
<td style="text-align: left">[ 9 16]</td>
<td style="text-align: right">124097</td>
<td style="text-align: right">0.032902</td>
<td style="text-align: right">0.902519</td>
<td style="text-align: right">1461785</td>
<td style="text-align: right">0.030531</td>
</tr>
<tr>
<td style="text-align: left">[17 32]</td>
<td style="text-align: right">92527</td>
<td style="text-align: right">0.024532</td>
<td style="text-align: right">0.927051</td>
<td style="text-align: right">2169840</td>
<td style="text-align: right">0.045319</td>
</tr>
<tr>
<td style="text-align: left">[33 64]</td>
<td style="text-align: right">95485</td>
<td style="text-align: right">0.025316</td>
<td style="text-align: right">0.952367</td>
<td style="text-align: right">4460504</td>
<td style="text-align: right">0.093162</td>
</tr>
<tr>
<td style="text-align: left">[ 65 128]</td>
<td style="text-align: right">86898</td>
<td style="text-align: right">0.023039</td>
<td style="text-align: right">0.975406</td>
<td style="text-align: right">7960106</td>
<td style="text-align: right">0.166254</td>
</tr>
<tr>
<td style="text-align: left">[129 256]</td>
<td style="text-align: right">59621</td>
<td style="text-align: right">0.015807</td>
<td style="text-align: right">0.991214</td>
<td style="text-align: right">10652590</td>
<td style="text-align: right">0.222490</td>
</tr>
<tr>
<td style="text-align: left">[257 512]</td>
<td style="text-align: right">25492</td>
<td style="text-align: right">0.006759</td>
<td style="text-align: right">0.997972</td>
<td style="text-align: right">8831357</td>
<td style="text-align: right">0.184451</td>
</tr>
<tr>
<td style="text-align: left">[ 513 1024]</td>
<td style="text-align: right">6514</td>
<td style="text-align: right">0.001727</td>
<td style="text-align: right">0.999699</td>
<td style="text-align: right">4387801</td>
<td style="text-align: right">0.091643</td>
</tr>
<tr>
<td style="text-align: left">[1025 2031]</td>
<td style="text-align: right">1025</td>
<td style="text-align: right">0.000272</td>
<td style="text-align: right">0.999971</td>
<td style="text-align: right">1356671</td>
<td style="text-align: right">0.028335</td>
</tr>
<tr>
<td style="text-align: left">[2049 4022]</td>
<td style="text-align: right">103</td>
<td style="text-align: right">0.000027</td>
<td style="text-align: right">0.999998</td>
<td style="text-align: right">262623</td>
<td style="text-align: right">0.005485</td>
</tr>
<tr>
<td style="text-align: left">[4103 6015]</td>
<td style="text-align: right">6</td>
<td style="text-align: right">0.000002</td>
<td style="text-align: right">1.000000</td>
<td style="text-align: right">28574</td>
<td style="text-align: right">0.000597</td>
</tr>
</tbody>
</table>
<p><img src="./Improving the Hacker News Ranking Algorithm _ Felix Dietze’s blog_files/submission_and_votes_distribution_over_score_intervals.svg" alt="Histogram"></p>
<p>We observe that almost half of all submissions did not get any upvote at all (score = 1). It’s also interesting to see that most votes get absorbed by few submissions which are on the frontpage (score 64-1024).</p>
<p>But are these submissions just spam and low-quality submissions? Let’s have another look at the data and see if there are high quality URLs which have a submission without an upvote.</p>
<table>
<thead>
<tr>
<th style="text-align: left">title</th>
<th style="text-align: left">scores_by_time</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left">2048</td>
<td style="text-align: left">[2903 1]</td>
</tr>
<tr>
<td style="text-align: left">GitHub Sponsors</td>
<td style="text-align: left">[2082 1]</td>
</tr>
<tr>
<td style="text-align: left">Zoom closes account of U.S.-based Chinese activist after Tiananmen event</td>
<td style="text-align: left">[ 1 2003]</td>
</tr>
<tr>
<td style="text-align: left">NPM and Left-Pad: Have We Forgotten How to Program?</td>
<td style="text-align: left">[1725 1]</td>
</tr>
<tr>
<td style="text-align: left">It Can Happen to You</td>
<td style="text-align: left">[ 5 1 1683]</td>
</tr>
<tr>
<td style="text-align: left">A Protocol for Dying</td>
<td style="text-align: left">[1610 1]</td>
</tr>
<tr>
<td style="text-align: left">Extremely disillusioned with technology. Please help</td>
<td style="text-align: left">[ 1 1527]</td>
</tr>
<tr>
<td style="text-align: left">Amazon Web Services in Plain English</td>
<td style="text-align: left">[1479 1 483]</td>
</tr>
<tr>
<td style="text-align: left">Explain Shell</td>
<td style="text-align: left">[1372 2 1 2 775]</td>
</tr>
<tr>
<td style="text-align: left">Diamonds Suck (2006)</td>
<td style="text-align: left">[ 5 1336 392 1 2 2 51]</td>
</tr>
<tr>
<td style="text-align: left">Join the Battle for Net Neutrality</td>
<td style="text-align: left">[ 1 1269]</td>
</tr>
<tr>
<td style="text-align: left">Why did moving the mouse cursor cause Windows 95 to run more quickly?</td>
<td style="text-align: left">[ 4 1 1188 1]</td>
</tr>
<tr>
<td style="text-align: left">Fred’s ImageMagick Scripts</td>
<td style="text-align: left">[ 6 1149 1]</td>
</tr>
<tr>
<td style="text-align: left">FTC Probing Facebook for Use of Personal Data, Source Says</td>
<td style="text-align: left">[1107 1]</td>
</tr>
<tr>
<td style="text-align: left">Why nobody ever wins the car at the mall</td>
<td style="text-align: left">[ 1 1104 1 2]</td>
</tr>
<tr>
<td style="text-align: left">Deep Photo Style Transfer</td>
<td style="text-align: left">[ 1 1088]</td>
</tr>
<tr>
<td style="text-align: left">Quick, Draw</td>
<td style="text-align: left">[ 13 1083 1 1]</td>
</tr>
<tr>
<td style="text-align: left">Laws of UX</td>
<td style="text-align: left">[ 3 3 535 5 1 1 2 1037]</td>
</tr>
<tr>
<td style="text-align: left">How to Center in CSS</td>
<td style="text-align: left">[1036 1]</td>
</tr>
<tr>
<td style="text-align: left">Google Dataset Search</td>
<td style="text-align: left">[1035 1 1]</td>
</tr>
<tr>
<td style="text-align: left">Cursors</td>
<td style="text-align: left">[1032 6 1 3 3 2]</td>
</tr>
<tr>
<td style="text-align: left">How to Build Good Software</td>
<td style="text-align: left">[ 20 4 1016 1 1]</td>
</tr>
<tr>
<td style="text-align: left">You might not need jQuery</td>
<td style="text-align: left">[994 1]</td>
</tr>
<tr>
<td style="text-align: left">A new kind of map: it’s about time</td>
<td style="text-align: left">[ 1 968]</td>
</tr>
<tr>
<td style="text-align: left">On Being a Principal Engineer</td>
<td style="text-align: left">[ 2 4 2 1 893]</td>
</tr>
<tr>
<td style="text-align: left">70TB of Parler users’ messages, videos, and posts leaked by security researchers</td>
<td style="text-align: left">[ 1 892]</td>
</tr>
<tr>
<td style="text-align: left">The Motherfucking Manifesto For Programming, Motherfuckers</td>
<td style="text-align: left">[884 1 1 1]</td>
</tr>
<tr>
<td style="text-align: left">Why I Quit Being So Accommodating (1922)</td>
<td style="text-align: left">[ 1 2 866]</td>
</tr>
<tr>
<td style="text-align: left">The Refragmentation</td>
<td style="text-align: left">[852 2 4 3 1]</td>
</tr>
<tr>
<td style="text-align: left">Things I Learnt from a Senior Software Engineer</td>
<td style="text-align: left">[ 1 849]</td>
</tr>
</tbody>
</table>
<p>We observe that there are indeed very high quality URLs that have been overlooked at least once on the new-page. This means that zero upvotes do not necessarily mean low quality. Zero upvotes mean uncertainty. But this uncertainty looks the same as low quality for the ranking algorithm and therefore gets penalized. This analysis shows that we do have false negatives with potential high quality among our zero upvote submissions.</p>
<h1 id="why-does-this-happen">Why does this happen?</h1>
<p>Explaining overlooked submissions on the new-page is simple: Not enough people look at the new-page to spot all high quality submissions. With the current amount of users and submission rate, many submissions just slip through the new-page without being noticed.</p>
<p>Explaining the score inconsistency for submissions that all appeared on the front-page is a bit more complicated. Let’s understand the current ranking algorithm first.</p>
<p>The new-page is showing the latest submissions, ordered by submission time. To calculate the front-page, the algorithm takes the newest 1500 submissions which have at least two upvotes, applies the ranking formula and sorts by the resulting value. Here is the <a href="https://medium.com/hacking-and-gonzo/how-hacker-news-ranking-algorithm-works-1d9b0cf2c08d">formula</a>:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>rankingScore = pow(upvotes, 0.8) / pow(ageHours + 2, 1.8)
</code></pre></div></div>
<p>To understand the formula, let’s oversimplify it. An exponent of <code class="language-plaintext highlighter-rouge">0.8</code> is almost linear and an exponent of <code class="language-plaintext highlighter-rouge">1.8</code> is almost quadratic. We also ignore the <code class="language-plaintext highlighter-rouge">+ 2</code>:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>upvotes / ageHours^2
</code></pre></div></div>
<p>It means that the submissions on the front-page are basically ordered by their number of upvotes with a quadratic age penalty. At the age of 2 hours, the upvotes count only as <code class="language-plaintext highlighter-rouge">1/2^2 = 1/4 = 25%</code>, after 5 hours only <code class="language-plaintext highlighter-rouge">1/5^2 = 1/25 = 4%</code> and after 25 hours a submission’s score counts just <code class="language-plaintext highlighter-rouge">1/25^2 = 1/625 = 0.16%</code>.</p>
<p>Now let’s imagine a front-page where all submissions have <strong>exactly the same quality</strong> and were submitted at <strong>exactly the same time</strong>. The front-page would just sort the submissions by their number of votes because they all have the same age penalty. Higher ranked submissions get more views and therefore more upvotes, which results in an even higher rank, more views, more upvotes and so on. This is called a <a href="https://en.wikipedia.org/wiki/Positive_feedback">positive feedback loop</a>.</p>
<p><img src="./Improving the Hacker News Ranking Algorithm _ Felix Dietze’s blog_files/feedback-loop.svg" alt="Positive Feedback loop. Three bubbles pointing at each other in a circle with a plus-sign on the arrows: &quot;views&quot; points to &quot;upvotes&quot;, which points to &quot;rank&quot;, which points to views. A fourth bubble &quot;age&quot; pointing with a minus-sign at &quot;rank&quot;."></p>
<p>We define a view as a click by a registered user on a submission, so the user sees the submitted content. For <a href="https://news.ycombinator.com/ask">Ask HN</a>, the content would be the comments page. We only look at registered users, because these views are the only ones that can lead to more upvotes.</p>
<p>If many submissions compete for upvotes, the positive feedback loop creates a rich-get-richer phenomenon. Submissions with an already high number of upvotes are likely to get even more upvotes than others.</p>
<p>Every user acts on their own and decides when to visit the front-page and which submissions to vote on. If we imagine thousands of users looking at the front-page, the views and votes on the ranks follow a distribution where higher ranks receive more views than lower ranks. The graphic was created using the <a href="https://github.com/HackerNews/API">Hacker News API</a> and observing score changes over time for every rank.</p>
<p><img src="./Improving the Hacker News Ranking Algorithm _ Felix Dietze’s blog_files/votehist.svg" alt="Histogram of vote distribution by ranks on the front page. In decreasing ranks: 13%, 7%, 6%, 5%, 4%, 4%, 3% and flattening. With a hard drop on rank 30 (page 2)"></p>
<p>Let’s imagine the just mentioned front-page in combination with those thousands of users, viewing and voting on the individual ranks. The first vote hitting a random rank increases the upvote count of that specific submission and pushes it to the top of the list. Now, that submission has a higher chance of receiving even more upvotes, but only because it received an upvote early.</p>
<p>If we run a second experiment and the first vote randomly hits a different rank and submission, then that specific submission has a better chance to get more upvotes. After many votes the ranking stabilizes and the high ranking submissions stay at high ranks while the lower ranked ones stay at lower ranks, without any chance to reach a high rank again.</p>
<p>Which submissions stabilize at high ranks depends on where the early votes land, which is completely random (submissions all have the same quality). This means that random submissions get high stable ranks even though they have the same quality.</p>
<p>With submissions <strong>submitted at different points in time</strong>, the age penalty kicks in and pulls stabilized random submissions back down. This allows other random rich submissions to exploit their feedback loop, get richer, and move up to higher ranks.</p>
<p>Now let’s put everything back together and imagine submissions with <strong>different qualities</strong> on the front-page. A higher quality submission sitting on the same rank as a lower quality submission should get slightly more upvotes, because more users identify its quality and vote on it. But in reality, two submissions cannot have the same rank. One of the two submissions is ranked higher and therefore receives more views and upvotes. The difference in quality is not strong enough to outperform the different amount of votes coming in on different ranks.</p>
<p>This means, that <strong>despite differences in the quality of submissions, random submissions rise to the top of the front-page</strong>. Therefore, the number of votes does not correlate with a submission’s quality. This is a very strong claim. Additionally to the data shown before, we’re working on confirming this claim with a simulated front-page and will write about it in the future.</p>
<h1 id="how-can-the-ranking-algorithm-be-improved">How can the Ranking Algorithm be Improved?</h1>
<p>We’re working on alternative solutions with the following goals in mind:</p>
<ul>
<li>The algorithm should not produce false negatives, the community should find <strong>all</strong> high-quality content.</li>
<li>Scores should correlate with quality so that submissions can be compared</li>
<li>The quality of content on a future version of the front-page should be at least as high as on the current version of the front-page</li>
<li>The user-interface should stay exactly the same</li>
<li>The age penalty should behave the same way as it was designed</li>
<li>Bonus: A higher overall quality on the frontpage</li>
<li>Bonus: Make it more difficult to game the system</li>
</ul>
<p><strong>The core idea of our approaches is to balance the positive feedback loop, such that instead of the rich getting richer and rising to the top, the highest quality rises to the top.</strong></p>
<p>There are many ways to do this. In our opinion, the following is the most promising one that can be implemented in Hacker News:</p>
<p>To balance the feedback loop, we add negative feedback: <strong>More views of a submission should lead to a lower rank</strong>. It turns the positive feedback loop into a <strong><a href="https://en.wikipedia.org/wiki/Negative_feedback">balancing feedback loop</a></strong> that converges on the right amount of votes.</p>
<p>This can be achieved by normalizing the current ranking formula with the number of views:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>               pow(upvotes, 0.8) / pow(ageHours + 2, 1.8)
rankingScore = ------------------------------------------
                                views + 1
</code></pre></div></div>
<p><img src="./Improving the Hacker News Ranking Algorithm _ Felix Dietze’s blog_files/feedback-loop-balanced.svg" alt="Balancing Positive Feedback loop. Like in in the previous diagram: three bubbles pointing at each other in a circle with a plus-sign on the arrows: &quot;views&quot; points to &quot;upvotes&quot;, which points to &quot;rank&quot;, which points to views. A fourth bubble &quot;age&quot; pointing with a minus-sign at &quot;rank&quot;. Additionally to the previous diagram, there is an arrow with a minus-sign from &quot;views&quot; to &quot;rank&quot;."></p>
<p>To understand why this works, imagine two submissions with the same number of upvotes and a different number of views. The article with more views probably has a lower quality than the one with fewer views, because more people have viewed it without giving an upvote. So the ratio of upvotes and views is a signal of quality.</p>
<p>By adding <code class="language-plaintext highlighter-rouge">/ views</code> to the formula, it contains exactly this ratio. Sorting by this ratio moves high-quality content to higher ranks. And at higher ranks, submissions get more views and upvotes, so the ratio becomes more accurate and converges. This makes the ratio comparable and thus a good indicator of quality. Interestingly, higher ratios will also have more upvotes, because of the ranking. And that is exactly what we are after: The number of upvotes correlates with quality.</p>
<p>This would solve the problem of correlation between upvote and quality on the front page. But high quality submissions can still be overlooked on the new page (false negatives).</p>
<p>The purpose of the new-page is to act as an initial filter and separate good from bad quality submissions. To achieve this goal, the new-page should expose every submission to a certain amount of views, to estimate its eligibility for the front-page.</p>
<p>To fulfill this purpose without false negatives, we propose to use the same front-page formula on the new-page. In this case the new-page would look almost the same as the front-page where high quality submissions are at the top. To unclutter the new-page and make room for new submissions, there could be an upvote threshold (= quality threshold), above which submissions are shown on the front-page and below which submissions are shown on the new-page.</p>
<h2 id="early-simulations">Early Simulations</h2>
<p>We want to verify with simulations, if our proposal indeed meets the goals of Hacker News. In addition to that, we want to try other algorithms and see how those compare. Simplified proof of concept simulations already confirm that it’s working as described.</p>
<p>Here are a few plots of our early, simplified simulations. In these simulations, all submissions are shown immediately on the frontpage and ranked by the formula. There is no new-page. Submissions have a predifined uniform random quality between 0 and 1. Random agents with an expectation threshold look at the frontpage and vote on submissions based on their quality. The agents look more freqently at higher ranks.</p>
<p>Please keep in mind that these simulations have simplified assumptions that do not correspond to reality. For example, the quality distribution is uniform and the vote distribution does not follow that of the real front page. The plots are there to show that our ideas can work. And we are currently working on creating better simulations.</p>
<h3 id="original-hacker-news-formula">Original Hacker News formula</h3>
<p><img src="./Improving the Hacker News Ranking Algorithm _ Felix Dietze’s blog_files/hacker-news-upvote-quality-scatterplot.png" alt="Scatterplot with quality on x-axis (0-1) and upvotes on y-axis (0-120). The points roughly describe a filled triangle from (0 quality,0 upvotes) over (1 quality, 0 upvotes) to about (1 quality, 40 upvotes)."></p>
<p>Every point is a submission that went through the frontpage simulation. The x-axis shows its predefined quality and the y-axis its upvotes. We can see that higher quality content has the chance to reach higher scores. There are no false positives (low quality content with high score), but there are many false negatives (high quality content with low score). Some outliers have very high scores.</p>
<h3 id="hacker-news-formula-divided-by-views">Hacker News formula divided by views</h3>
<p>If we use our proposed formula which divides the scoreRank by views, we get the following:
<img src="./Improving the Hacker News Ranking Algorithm _ Felix Dietze’s blog_files/hacker-news-normalized-upvote-quality-scatterplot.png" alt="Scatterplot with quality on x-axis (0-1) and upvotes on y-axis (0-35). The points roughly describe a thick fuzzy line from (0 quality,0 upvotes) to about (1 quality, 15 upvotes). There are almost no points in the area below the line (high quality, few upvotes)."></p>
<p>Now there are basically no false-negatives (high quality with low score) anymore and the upvotes correlate much better with quality.</p>
<h1 id="conclusion-and-future-work">Conclusion and Future Work</h1>
<p>We analyzed two problems of the current Hacker News ranking algorithm and confirmed them with data: 1) The number of upvotes does not correlate with quality. 2) High quality submissions are overlooked on the new-page. We explained that the root cause of these problems is the ranking algorithm itself. It introduces a rich-get-richer effect, which lets arbitrary high quality submissions rise to the top, while others don’t get much attention. Additionally, the new-page does not get enough votes to identify all high-quality submissions.</p>
<p>We proposed a small modification to the Hacker News ranking formula, which turns the positive feedback loop into a balancing feedback loop: Dividing the result of the formula by the number of views a submission receives.</p>
<p>We already evaluated the effectiveness of this approach with oversimplified proof-of-concept simulations. And the results are quite promising. But there’s more work to do. Currently, we’re working on a more realistic simulation with the goal to behave the same as Hacker News in reality - including a new-page. If we’re accurate enough, we can evaluate how different formulas change the resulting front-page. But more on that in the future.</p>
<p>Thanks for reading. We appreciate any feedback and ideas. We’re also looking for ways to fund our research. Please get in touch!</p>
<h1 id="appendix">Appendix</h1>
<h2 id="bigquery-sql-queries">BigQuery sql queries</h2>
<p>These queries can be run on the <a href="https://console.cloud.google.com/marketplace/product/y-combinator/hacker-news">Hacker News Dataset</a> on BigQuery. You can fork our <a href="https://www.kaggle.com/felixdietze/hacker-news-score-analysis">Kaggle Notebook</a> to start.</p>
<h3 id="all-scores-of-urls-with-multiple-submissions">All scores of urls with multiple submissions</h3>
<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">-- note: score = upvotes + 1</span>
<span class="k">SELECT</span>
    <span class="n">title</span><span class="p">,</span>
    <span class="n">ARRAY_AGG</span><span class="p">(</span><span class="n">score</span> <span class="k">order</span> <span class="k">by</span> <span class="nb">time</span> <span class="k">ASC</span><span class="p">)</span> <span class="k">as</span> <span class="n">scores_by_time</span><span class="p">,</span>
    <span class="n">DATE_DIFF</span><span class="p">(</span><span class="nb">DATE</span><span class="p">(</span><span class="n">TIMESTAMP_SECONDS</span><span class="p">(</span><span class="k">MAX</span><span class="p">(</span><span class="nb">time</span><span class="p">))),</span><span class="nb">DATE</span><span class="p">(</span><span class="n">TIMESTAMP_SECONDS</span><span class="p">(</span><span class="k">MIN</span><span class="p">(</span><span class="nb">time</span><span class="p">))),</span> <span class="k">DAY</span><span class="p">)</span> <span class="k">as</span> <span class="n">days</span><span class="p">,</span>
<span class="k">FROM</span> <span class="nv">`bigquery-public-data.hacker_news.full`</span>
<span class="k">WHERE</span> <span class="nv">`type`</span> <span class="o">=</span> <span class="s1">'story'</span> <span class="k">AND</span> <span class="n">url</span> <span class="o">!=</span> <span class="s1">''</span> <span class="k">AND</span> <span class="n">score</span> <span class="k">IS</span> <span class="k">NOT</span> <span class="k">NULL</span> <span class="k">AND</span> <span class="n">score</span> <span class="o">&gt;=</span> <span class="mi">3</span>
<span class="k">GROUP</span> <span class="k">BY</span> <span class="n">url</span><span class="p">,</span><span class="n">title</span>
<span class="k">HAVING</span> <span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">4</span> <span class="k">AND</span> <span class="n">days</span> <span class="o">&lt;=</span> <span class="mi">30</span>
<span class="k">ORDER</span> <span class="k">BY</span> <span class="k">max</span><span class="p">(</span><span class="n">score</span><span class="p">)</span> <span class="k">DESC</span>
<span class="k">LIMIT</span> <span class="mi">30</span>
</code></pre></div></div>
<h3 id="scores-of-urls-with-multiple-submissions-at-the-same-time-of-day">Scores of urls with multiple submissions at the same time of day</h3>
<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">WITH</span>
    <span class="n">stories</span> <span class="k">AS</span> <span class="p">(</span>
        <span class="k">SELECT</span> <span class="o">*</span>
        <span class="k">FROM</span> <span class="nv">`bigquery-public-data.hacker_news.full`</span>
        <span class="k">WHERE</span> <span class="nv">`type`</span> <span class="o">=</span> <span class="s1">'story'</span> <span class="k">AND</span> <span class="n">url</span> <span class="o">!=</span> <span class="s1">''</span> <span class="k">AND</span> <span class="n">score</span> <span class="k">IS</span> <span class="k">NOT</span> <span class="k">NULL</span> <span class="k">AND</span> <span class="n">score</span> <span class="o">&gt;</span> <span class="mi">0</span>
        <span class="k">ORDER</span> <span class="k">BY</span> <span class="nb">time</span> <span class="k">DESC</span>
    <span class="p">)</span>
<span class="k">SELECT</span>
    <span class="n">ARRAY_AGG</span><span class="p">(</span><span class="n">score</span> <span class="k">ORDER</span> <span class="k">BY</span> <span class="nb">time</span><span class="p">)</span> <span class="n">scores</span><span class="p">,</span>
    <span class="n">ARRAY_AGG</span><span class="p">(</span><span class="k">EXTRACT</span><span class="p">(</span><span class="n">HOUR</span> <span class="k">FROM</span> <span class="nb">timestamp</span><span class="p">)</span> <span class="k">order</span> <span class="k">by</span> <span class="nb">time</span> <span class="k">ASC</span><span class="p">)</span> <span class="n">time_of_day</span><span class="p">,</span>
    <span class="n">stddev</span><span class="p">(</span><span class="k">EXTRACT</span><span class="p">(</span><span class="n">HOUR</span> <span class="k">FROM</span> <span class="nb">timestamp</span><span class="p">)</span><span class="o">+</span><span class="k">EXTRACT</span><span class="p">(</span><span class="k">MINUTE</span> <span class="k">FROM</span> <span class="nb">timestamp</span><span class="p">)</span><span class="o">/</span><span class="mi">60</span><span class="p">)</span> <span class="n">time_of_day_stddev</span><span class="p">,</span>
    <span class="n">DATE_DIFF</span><span class="p">(</span><span class="nb">DATE</span><span class="p">(</span><span class="n">TIMESTAMP_SECONDS</span><span class="p">(</span><span class="k">MAX</span><span class="p">(</span><span class="nb">time</span><span class="p">))),</span><span class="nb">DATE</span><span class="p">(</span><span class="n">TIMESTAMP_SECONDS</span><span class="p">(</span><span class="k">MIN</span><span class="p">(</span><span class="nb">time</span><span class="p">))),</span> <span class="k">DAY</span><span class="p">)</span> <span class="k">as</span> <span class="n">days</span><span class="p">,</span>
<span class="k">FROM</span> <span class="n">stories</span>
<span class="k">GROUP</span> <span class="k">BY</span> <span class="n">url</span><span class="p">,</span><span class="n">title</span>
<span class="k">HAVING</span>
    <span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">3</span> <span class="k">AND</span> <span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">10</span>
    <span class="k">AND</span> <span class="k">max</span><span class="p">(</span><span class="n">score</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">50</span>
    <span class="k">AND</span> <span class="n">days</span> <span class="o">&lt;</span> <span class="mi">90</span>
    <span class="k">AND</span> <span class="n">time_of_day_stddev</span> <span class="o">&lt;=</span> <span class="mi">2</span><span class="p">.</span><span class="mi">5</span>

<span class="k">ORDER</span> <span class="k">BY</span> <span class="k">count</span><span class="p">(</span><span class="n">score</span><span class="p">)</span> <span class="k">DESC</span><span class="p">,</span> <span class="n">time_of_day_stddev</span> <span class="k">ASC</span>
<span class="k">LIMIT</span> <span class="mi">20</span>
</code></pre></div></div>
<p>Note: We understand that the standard deviation of time-of-day should ideally be calculated using a <a href="https://en.wikipedia.org/wiki/Circular_mean">circular mean</a>, but we wanted to keep it simple.</p>
<h3 id="distribution-of-upvote-counts">Distribution of upvote counts</h3>
<p>For example: How many submissions got between 3 and 4 upvotes?</p>
<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">WITH</span>
    <span class="n">stories</span> <span class="k">AS</span> <span class="p">(</span>
        <span class="k">SELECT</span> <span class="o">*</span>
        <span class="k">FROM</span> <span class="nv">`bigquery-public-data.hacker_news.full`</span>
        <span class="k">WHERE</span> <span class="nv">`type`</span> <span class="o">=</span> <span class="s1">'story'</span> <span class="k">AND</span> <span class="n">url</span> <span class="o">!=</span> <span class="s1">''</span> <span class="k">AND</span> <span class="n">score</span> <span class="k">IS</span> <span class="k">NOT</span> <span class="k">NULL</span> <span class="k">AND</span> <span class="n">score</span> <span class="o">&gt;</span> <span class="mi">0</span>
    <span class="p">),</span>
    <span class="n">intervals</span> <span class="k">AS</span> <span class="p">(</span>    
        <span class="k">SELECT</span>
            <span class="k">min</span><span class="p">(</span><span class="n">score</span><span class="p">)</span> <span class="k">as</span> <span class="n">min_score</span><span class="p">,</span>
            <span class="k">max</span><span class="p">(</span><span class="n">score</span><span class="p">)</span> <span class="k">as</span> <span class="n">max_score</span><span class="p">,</span>
            <span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="k">as</span> <span class="n">submissions</span><span class="p">,</span>
            <span class="k">SUM</span><span class="p">(</span><span class="n">score</span><span class="p">)</span> <span class="k">as</span> <span class="n">total_votes</span><span class="p">,</span>
        <span class="k">FROM</span>
            <span class="n">stories</span>
        <span class="k">GROUP</span> <span class="k">BY</span>
            <span class="n">ceil</span><span class="p">(</span><span class="n">log</span><span class="p">(</span><span class="n">score</span><span class="p">)</span><span class="o">/</span><span class="n">log</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
    <span class="p">),</span>
    <span class="n">totals</span> <span class="k">AS</span> <span class="p">(</span>
        <span class="k">SELECT</span>
            <span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="k">AS</span> <span class="n">total</span><span class="p">,</span>
            <span class="k">sum</span><span class="p">(</span><span class="n">score</span><span class="p">)</span> <span class="k">AS</span> <span class="n">total_score</span><span class="p">,</span>
        <span class="k">FROM</span> <span class="n">stories</span>
    <span class="p">)</span>
<span class="k">SELECT</span>
    <span class="n">max_score</span><span class="p">,</span>
    <span class="p">[</span><span class="n">min_score</span><span class="p">,</span> <span class="n">max_score</span><span class="p">]</span> <span class="k">as</span> <span class="n">score_interval</span><span class="p">,</span>
    <span class="n">submissions</span><span class="p">,</span>
    <span class="n">submissions</span> <span class="o">/</span> <span class="n">totals</span><span class="p">.</span><span class="n">total</span> <span class="k">as</span> <span class="n">subm_fraction</span><span class="p">,</span>
    <span class="p">(</span><span class="k">SELECT</span> <span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">stories</span> <span class="k">where</span> <span class="n">score</span> <span class="o">&lt;=</span> <span class="n">max_score</span><span class="p">)</span> <span class="o">/</span> <span class="n">totals</span><span class="p">.</span><span class="n">total</span> <span class="k">as</span> <span class="n">cumulative_subm_fraction</span><span class="p">,</span>
    <span class="n">total_votes</span><span class="p">,</span>
    <span class="n">total_votes</span> <span class="o">/</span> <span class="n">totals</span><span class="p">.</span><span class="n">total_score</span> <span class="k">as</span> <span class="n">votes_fraction</span><span class="p">,</span>
<span class="k">FROM</span>
    <span class="n">intervals</span><span class="p">,</span>
    <span class="n">totals</span>
<span class="k">ORDER</span> <span class="k">BY</span>
    <span class="n">min_score</span> <span class="k">ASC</span>
</code></pre></div></div>
<h3 id="high-quality-submissions-without-upvotes">High quality submissions without upvotes</h3>
<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span>
    <span class="n">title</span><span class="p">,</span>
    <span class="n">ARRAY_AGG</span><span class="p">(</span><span class="n">score</span> <span class="k">order</span> <span class="k">by</span> <span class="nb">time</span> <span class="k">ASC</span><span class="p">)</span> <span class="k">as</span> <span class="n">scores_by_time</span><span class="p">,</span>
<span class="k">FROM</span> <span class="nv">`bigquery-public-data.hacker_news.full`</span>
<span class="k">WHERE</span> <span class="nv">`type`</span> <span class="o">=</span> <span class="s1">'story'</span> <span class="k">AND</span> <span class="n">url</span> <span class="o">!=</span> <span class="s1">''</span> <span class="k">AND</span> <span class="n">score</span> <span class="k">IS</span> <span class="k">NOT</span> <span class="k">NULL</span> <span class="k">AND</span> <span class="n">score</span> <span class="o">&gt;</span> <span class="mi">0</span>
<span class="k">GROUP</span> <span class="k">BY</span> <span class="n">url</span><span class="p">,</span><span class="n">title</span>
<span class="k">HAVING</span> <span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">2</span> <span class="k">AND</span> <span class="k">min</span><span class="p">(</span><span class="n">score</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span>
<span class="k">ORDER</span> <span class="k">BY</span> <span class="k">max</span><span class="p">(</span><span class="n">score</span><span class="p">)</span> <span class="k">DESC</span>
<span class="k">LIMIT</span> <span class="mi">30</span>
</code></pre></div></div>
<h2 id="alternative-formulas">Alternative formulas</h2>
<p>We also experimented with other balancing feedback loop formulas, that have interesting properties:</p>
<h3 id="only-downvotes">Only downvotes</h3>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>rankingScore = -(downvotes+1) * age
</code></pre></div></div>
<p><img src="./Improving the Hacker News Ranking Algorithm _ Felix Dietze’s blog_files/hacker-news-downvotes-quality-scatterplot.png" alt="Scatterplot with quality on x-axis (0-1) and downvotes on y-axis (-18 - 0). The points roughly describe a thick fuzzy line from (0 quality,-11 downvotes) to about (1 quality, -3 downvotes). There are almost no points in the area below the line (high quality, many downvotes)."></p>
<p>Only having downvotes has very interesting properties. It’s much harder to promote your own content. Also, uncertainty (few votes) gets more attention (higher rank) instead of less, like it does for upvote based systems.</p>
<h3 id="upvotes-with-views-as-downvotes">Upvotes with views as downvotes</h3>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>rankingScore = (upvotes-views-1) * age
</code></pre></div></div>
<p><img src="./Improving the Hacker News Ranking Algorithm _ Felix Dietze’s blog_files/hacker-news-views-as-downvotes-quality-scatterplot.png" alt="Scatterplot with quality on x-axis (0-1) and upvotes on y-axis (-16 - 0). The points roughly describe a thick fuzzy line from (0 quality,-11 upvotes) to about (1 quality, -3 downvotes). There are almost no points in the area below the line (high quality, many downvotes). The shape looks very similar to the one with only downvotes."></p>
<p>Interestingly, this formula seems to behave very similar to the downvote-only formula. Even though the users still have an upvote button.</p>
</article>
</main>
<footer class="footer">
<div class="footer-column">
<p>
<small>
©&nbsp;<time datetime="2021-02-20T00:00:00+00:00">2021</time>-<time datetime="2023-12-21T06:41:12+00:00">2023</time>
Felix Dietze. All right reserved.
</small>
</p>
<p>
<small>
Powered by <a href="https://jekyllrb.com/" target="_blank">Jekyll</a> &amp; <a href="https://github.com/zivhub/monophase" target="_blank">Monophase</a>
</small>
</p>
</div>
<div class="footer-column">
<ul class="social-icons">
<li class="social-icon-item">
<a class="social-icon" href="mailto:mail@felx.me" target="_blank">
<svg class="svg-inline--fa fa-envelope fa-w-16" title="Email" aria-labelledby="svg-inline--fa-title-1" data-prefix="fas" data-icon="envelope" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" data-fa-i2svg=""><title id="svg-inline--fa-title-1">Email</title><path fill="currentColor" d="M502.3 190.8c3.9-3.1 9.7-.2 9.7 4.7V400c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V195.6c0-5 5.7-7.8 9.7-4.7 22.4 17.4 52.1 39.5 154.1 113.6 21.1 15.4 56.7 47.8 92.2 47.6 35.7.3 72-32.8 92.3-47.6 102-74.1 131.6-96.3 154-113.7zM256 320c23.2.4 56.6-29.2 73.4-41.4 132.7-96.3 142.8-104.7 173.4-128.7 5.8-4.5 9.2-11.5 9.2-18.9v-19c0-26.5-21.5-48-48-48H48C21.5 64 0 85.5 0 112v19c0 7.4 3.4 14.3 9.2 18.9 30.6 23.9 40.7 32.4 173.4 128.7 16.8 12.2 50.2 41.8 73.4 41.4z"></path></svg><!-- <i class="fas fa-envelope" title="Email"></i> -->
</a>
</li>
<li class="social-icon-item">
<a class="social-icon" href="https://twitter.com/felixdietze" target="_blank">
<svg class="svg-inline--fa fa-twitter fa-w-16" title="Twitter" aria-labelledby="svg-inline--fa-title-2" data-prefix="fab" data-icon="twitter" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" data-fa-i2svg=""><title id="svg-inline--fa-title-2">Twitter</title><path fill="currentColor" d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"></path></svg><!-- <i class="fab fa-twitter" title="Twitter"></i> -->
</a>
</li>
<li class="social-icon-item">
<a class="social-icon" href="https://github.com/fdietze" target="_blank">
<svg class="svg-inline--fa fa-github fa-w-16" title="GitHub" aria-labelledby="svg-inline--fa-title-3" data-prefix="fab" data-icon="github" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512" data-fa-i2svg=""><title id="svg-inline--fa-title-3">GitHub</title><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg><!-- <i class="fab fa-github" title="GitHub"></i> -->
</a>
</li>
</ul>
</div>
</footer>
</div>


</body></html>